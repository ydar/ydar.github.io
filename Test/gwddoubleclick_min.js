(function(){"use strict";var g=function(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a};function h(){this.b={}}h.prototype.add=function(a,b){this.b[a]||(this.b[a]=[]);this.b[a].push(b)};function k(a,b){this.c=a;this.w=b;this.h=this.handleMetricEvent_.bind(this)}k.prototype.observe=function(a){if(a.nodeType==Node.ELEMENT_NODE)for(var b=Object.keys(this.c.b),d=0;d<b.length;d++){var c=document.getElementById(b[d]);c&&g(a,c)&&(this.c.b[b[d]]||[]).forEach(function(a){c.addEventListener(a.event,this.h,!1)}.bind(this))}};
var l=function(a,b){if(b.nodeType==Node.ELEMENT_NODE)for(var d=Object.keys(a.c.b),c=0;c<d.length;c++){var e=document.getElementById(d[c]);e&&g(b,e)&&(a.c.b[d[c]]||[]).forEach(function(a){e.removeEventListener(a.event,this.h,!1)}.bind(a))}};k.prototype.handleMetricEvent_=function(a){this.w(a)};document.registerElement&&document.registerElement("gwd-metric-event",{prototype:Object.create(HTMLElement.prototype,{})});document.registerElement&&document.registerElement("gwd-metric-configuration",{prototype:Object.create(HTMLElement.prototype,{})});document.registerElement&&document.registerElement("gwd-exit",{prototype:Object.create(HTMLElement.prototype,{})});document.registerElement&&document.registerElement("gwd-timer",{prototype:Object.create(HTMLElement.prototype,{})});document.registerElement&&document.registerElement("gwd-doubleclick",{prototype:Object.create(HTMLElement.prototype,{createdCallback:{value:function(){this.q=this.handleEnablerInit_.bind(this);this.i=this.handleEnablerVisible_.bind(this);this.p=this.handleEnablerPageLoaded_.bind(this);this.m=this.handleEnablerExpandStart_.bind(this);this.l=this.handleEnablerCollapseStart_.bind(this);this.h=this.handleMetricEvent_.bind(this);this.n=this.handlePageTransitionEnd_.bind(this);this.o=this.handleResize_.bind(this);
this.d=this.e=!1;this.j=[];this.r=window.innerHeight>=window.innerWidth?1:2},enumerable:!0},attachedCallback:{value:function(){Enabler.addEventListener(studio.events.StudioEvent.EXPAND_START,this.m);Enabler.addEventListener(studio.events.StudioEvent.COLLAPSE_START,this.l);this.a=this.querySelector("[is=gwd-pagedeck]");this.a.addEventListener("pagetransitionend",this.n,!1);this.c=this.getMetricConfiguration_();this.s=new k(this.c,this.h);window.addEventListener("resize",this.o,!1)},enumerable:!0},
detachedCallback:{value:function(){Enabler.removeEventListener(studio.events.StudioEvent.INIT,this.q);Enabler.removeEventListener(studio.events.StudioEvent.VISIBLE,this.i);Enabler.removeEventListener(studio.events.StudioEvent.PAGE_LOADED,this.p);Enabler.removeEventListener(studio.events.StudioEvent.EXPAND_START,this.m);Enabler.removeEventListener(studio.events.StudioEvent.COLLAPSE_START,this.l);this.a.removeEventListener("pagetransitionend",this.n,!1);window.removeEventListener("resize",this.o,!1)},
enumerable:!0},initAd:{value:function(){this.onEnablerInit_(this.q)},enumerable:!0},exit:{value:function(a,b,d){Enabler.exit(a,b);d&&this.goToPage()},enumerable:!0},exitOverride:{value:function(a,b,d){Enabler.exitOverride(a,b);d&&this.goToPage()},enumerable:!0},incrementCounter:{value:function(a,b){Enabler.counter(a,b)},enumerable:!0},startTimer:{value:function(a){Enabler.startTimer(a)},enumerable:!0},stopTimer:{value:function(a){Enabler.stopTimer(a)},enumerable:!0},reportManualClose:{value:function(){Enabler.reportManualClose()},
enumerable:!0},getMetricConfiguration_:{value:function(){var a=this.querySelector("gwd-metric-configuration"),b=new h;if(a)for(var a=Array.prototype.slice.call(a.getElementsByTagName("gwd-metric-event")),d=0;d<a.length;d++){var c=a[d],e=c.getAttribute("source");if(e){var f=c.getAttribute("exit"),c={event:c.getAttribute("event"),v:c.getAttribute("metric")||f,u:c.hasAttribute("cumulative"),exit:f};b.add(e,c)}}return b}},handleMetricEvent_:{value:function(a){var b=a.target,d=b.getAttribute("id")+": "+
a.type,c;i:{c=this.c.b[b.id]||[];for(var e=0;e<c.length;e++)if(c[e].event==a.type){c=c[e];break i}c=void 0}c.exit&&a.detail&&a.detail.url?(Enabler.exitOverride(b.id+": "+c.exit,a.detail.url),a.detail.handled=!0,a.detail.collapse&&this.goToPage()):this.incrementCounter(c.v||d,c.u)}},onEnablerInit_:{value:function(a){Enabler.isInitialized()?a():Enabler.addEventListener(studio.events.StudioEvent.INIT,a)},enumerable:!1},handleEnablerInit_:{value:function(){if(this.hasAttribute("polite-load"))this.onEnablerPageLoaded_(this.p);
else this.onEnablerVisible_(this.i)},enumerable:!1},onEnablerVisible_:{value:function(a){Enabler.isVisible()?a():Enabler.addEventListener(studio.events.StudioEvent.VISIBLE,a)},enumerable:!1},handleEnablerVisible_:{value:function(a){var b;a&&(b=a.detail);(a=b)?(b=document.createEvent("CustomEvent"),b.initCustomEvent("adinitialized",!0,!0,a)):(b=document.createEvent("Event"),b.initEvent("adinitialized",!0,!0));this.dispatchEvent(b);this.goToPage()},enumerable:!1},onEnablerPageLoaded_:{value:function(a){Enabler.isPageLoaded()?
a():Enabler.addEventListener(studio.events.StudioEvent.PAGE_LOADED,a)},enumerable:!1},handleEnablerPageLoaded_:{value:function(){this.onEnablerVisible_(this.i)},enumerable:!1},goToPage:{value:function(a,b,d,c,e){var f=this.a.getPage(this.a.currentIndex);if(a=a?this.a.getPage(a):this.a.getDefaultPage())a=this.a.getOrientationSpecificPage(window.innerHeight>=window.innerWidth?1:2,a.id),this.f=a.id,b&&(this.g={transition:b,duration:d,t:c,direction:e}),f&&a&&this.shouldExpand_(f,a)?Enabler.requestExpand():
f&&a&&this.shouldCollapse_(f,a)?Enabler.requestCollapse():(this.d=this.e=!1,this.goToNextPage_())},enumerable:!0},shouldExpand_:{value:function(a,b){return!this.e&&!a.hasAttribute("expanded")&&b.hasAttribute("expanded")}},shouldCollapse_:{value:function(a,b){return!this.d&&a.hasAttribute("expanded")&&!b.hasAttribute("expanded")}},handleEnablerExpandStart_:{value:function(){this.e=!0;Enabler.finishExpand();setTimeout(this.goToNextPage_.bind(this),30)},enumerable:!1},handleEnablerCollapseStart_:{value:function(){this.d=
!0;Enabler.finishCollapse();this.f||(this.reportManualClose(),this.f=this.a.getDefaultPage().id);setTimeout(this.goToNextPage_.bind(this),30)},enumerable:!1},handleResize_:{value:function(){if(!this.e&&!this.d){var a=window.innerHeight>=window.innerWidth?1:2;this.r!=a&&(this.r=a,(a=this.a.getPage(this.a.currentIndex))&&this.goToPage(a.id))}}},goToNextPage_:{value:function(){this.f&&(this.g?this.a.goToPage(this.f,this.g.transition,this.g.duration,this.g.t,this.g.direction):this.a.goToPage(this.f));
this.g=this.f=void 0}},handlePageTransitionEnd_:{value:function(a){this.e?this.e=!1:this.d&&(this.d=!1);if(a.target==this.a){var b=a.detail;a=b.outgoingPage;b=b.incomingPage;a&&this.handlePageUnbound_(a);this.handlePageBound_(b)}},enumerable:!1},handlePageBound_:{value:function(a){this.s.observe(a);if((a=a.querySelectorAll("video"))&&0<a.length){var b=studio.video&&studio.video.Reporter,d=this.registerVideoElements_.bind(this);this.k=Array.prototype.slice.call(a);b?d():Enabler.loadModule(studio.module.ModuleId.VIDEO,
d)}},enumerable:!1},handlePageUnbound_:{value:function(a){l(this.s,a);(a=a.querySelectorAll("video"))&&0<a.length&&this.unregisterVideoElements_()},enumerable:!1},registerVideoElements_:{value:function(){for(var a,b;this.k.length;)if(b=this.k.shift(),a=b.id)studio.video.Reporter.attach(a,b,b.autoplay),this.j.push(a)},enumerable:!1},unregisterVideoElements_:{value:function(){for(this.k=[];this.j.length;)studio.video.Reporter.detach(this.j.shift())},enumerable:!1}})});})()
